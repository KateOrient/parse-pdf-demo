(window["webpackJsonpreact-pdf-test"]=window["webpackJsonpreact-pdf-test"]||[]).push([[0],{100:function(e,t,a){},101:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(38),o=a.n(r),s=a(48),c=a(39),l=a(40),d=a(41),p=a(49),u=a(42),m=a(50),f=a(18),g=(a(99),a(21)),h=a.n(g),b=a(5),v=a.n(b);var y=function(e){var t=e.pageIndex,a=e.onPageRenderSuccess;return i.a.createElement(f.Page,{className:"pdf-page",pageNumber:t,renderAnnotationLayer:!0,renderInteractiveForms:!0,renderTextLayer:!0,onRenderSuccess:a,customTextRenderer:function(e){e.height,e.width,e.transform,e.scale,e.page;return e.str}})},N=a(43),x=a.n(N),E=a(44),P=a.n(E),w=a(45),O=a.n(w),k=a(46),C=a.n(k),j=a(47),T=a.n(j),S="small";var D=function(e){var t;function a(t){var a;switch(t){case"small":a=h.a;break;case"medium":a=x.a;break;case"big":a=P.a;break;case"huge":a=O.a;break;case"testWithPageTreeDepth2":a=C.a;break;case"testWithGraphics":a=T.a}return function(n){S=t,e.onUploadSctrictFile(a)}}return i.a.createElement("header",{className:"App-header"},i.a.createElement("section",{className:"","app-btn-pane":!0},i.a.createElement("button",{onClick:a("small"),className:"app-btn",disabled:"small"===S||e.loading},"Small pdf"),i.a.createElement("button",{onClick:a("medium"),className:"app-btn",disabled:"medium"===S||e.loading},"Medium pdf"),i.a.createElement("button",{onClick:a("big"),className:"app-btn",disabled:"big"===S||e.loading},"Big pdf"),i.a.createElement("button",{onClick:a("huge"),className:"app-btn",disabled:"huge"===S||e.loading},"Huge pdf"),i.a.createElement("button",{onClick:a("testWithPageTreeDepth2"),className:"app-btn",disabled:"testWithPageTreeDepth2"===S||e.loading},"Pdf with page tree depth of 2"),i.a.createElement("button",{onClick:a("testWithGraphics"),className:"app-btn",disabled:"testWithGraphics"===S||e.loading},"Pdf with graphics"),i.a.createElement("button",{onClick:function(){t.click()},className:"app-btn",disabled:e.loading},"Upload other pdf"),i.a.createElement("input",{type:"file",onChange:e.onUploadFile,ref:function(e){t=e},style:{display:"none"}})),i.a.createElement("div",{className:"pdf-loading"},e.loading?"Loading pdf...":""))};a(100);function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function B(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(a,!0).forEach(function(t){Object(c.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}f.pdfjs.GlobalWorkerOptions.workerSrc="pdf.worker.js";var R={containerRef:null,activeTagName:null,tagPath:null},I=0,L=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(p.a)(this,Object(u.a)(t).call(this,e))).onDocumentLoadSuccess=function(e){console.log(e);var t=e._pdfInfo.structureTree||{};e.getMetadata().then(function(e){var n=e.info,i=(e.metadata,e.contentDispositionFilename,n.RoleMap),r=n.ClassMap,o=n.Title||a.state.pdf.name;a.setState({title:o,structureTree:t,roleMap:i||{},classMap:r||{}})});var n=e.numPages;a.setState({numPages:n})},a.onPageRenderSuccess=function(e){e.getOperatorList().then(function(t){var n=t.argsArray[t.argsArray.length-1],i=B({},a.state.bboxByPage);i[e.pageIndex]=n||{},console.log("Data:",n);var r=document.getElementsByTagName("canvas")[e.pageIndex].getBoundingClientRect(),o=document.createElement("canvas");o.style.top=r.y+"px",o.style.left=r.x+"px",o.style.height=r.height+"px",o.style.width=r.width+"px",o.height=r.height,o.width=r.width,o.style.position="absolute",o.id="bboxCanvas"+e.pageIndex,o.setAttribute("data-page",e.pageIndex),R.containerRef.appendChild(o);var s=o.getContext("2d");s.translate(0,r.height),s.scale(1,-1),o.onmousemove=a.onBboxMove,++I===a.state.numPages?a.setState({loading:!1,bboxByPage:i}):a.state.bboxByPage=i})},a.findTag=function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v.a.cloneDeep(a.state.structureTree),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(i instanceof Array)return i.forEach(function(r){if(r){var s=a.findTag(e,t,r,i,o);s&&(n=s)}}),n;if(i instanceof Object){var c;if(!i.hasOwnProperty("mcid")||!i.hasOwnProperty("pageIndex"))return Object.keys(i).forEach(function(n){if(i[n]){var r=a.findTag(e,t,i[n],i,[].concat(Object(s.a)(o),[n]));r&&(c=r)}}),c;if(i.mcid===e&&i.pageIndex===t)return{path:o,relatives:v.a.flattenDeep(a.findChildren(r)).filter(function(e){return e})}}},a.findChildren=function(e){return null===e?[]:e instanceof Object?e.hasOwnProperty("mcid")&&e.hasOwnProperty("pageIndex")?e:Object.keys(e).map(function(t){return a.findChildren(e[t])}):e instanceof Array?e.map(function(e){return a.findChildren(e)}):void 0},a.onBboxMove=function(e){var t=e.target,n=t.getBoundingClientRect(),i=e.clientX-n.left,r=t.offsetHeight-(e.clientY-n.top),o=t.getContext("2d"),s=t.getAttribute("data-page"),c=a.state.bboxByPage[s];o.clearRect(0,0,t.offsetWidth,t.offsetHeight),o.strokeStyle="red";var l=a.isInBbox({x:i,y:r,bboxList:c});if(l){var d=parseInt(l.mcid),p=a.findTag(d,+s);if(p){var u=p.path,m=p.relatives.filter(function(e){return e.pageIndex===+s}),f="",g=Number.MAX_VALUE,h=0,b=Number.MAX_VALUE,y=0;m.forEach(function(e,t){var a=e.mcid,n=e.pageIndex;if(+s===n&&c[a]){var i=c[a],r=i.x,o=i.y,l=i.width,d=i.height;v.a.isNaN(r)||v.a.isNaN(o)||v.a.isNaN(l)||v.a.isNaN(d)||v.a.isNull(r)||v.a.isNull(o)||v.a.isNull(l)||v.a.isNull(d)||(t||(g=r,h=r+l,b=o,y=o+d),g=g<r?g:r,h=h>r+l?h:r+l,b=b<o?b:o,y=y>o+d?y:o+d)}}),o.strokeRect(g,b,h-g,y-b),a.state.roleMap[u[u.length-1]]&&(f="-> "+a.state.roleMap[u[u.length-1]].name),a.fillDocData("".concat(u[u.length-1]," ").concat(f),u.join(" -> "),d)}else o.strokeRect(l.x,l.y,l.width,l.height)}else a.fillDocData()},a.fillDocData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n="None";e?(R.activeTagName.textContent=e,R.tagPath.classList.remove("_empty")):(R.activeTagName.textContent=n,R.tagPath.classList.add("_empty")),t?(R.tagPath.textContent=t,R.activeTagName.classList.remove("_empty")):(R.tagPath.textContent=n,R.activeTagName.classList.add("_empty")),Number.isInteger(a)?(R.mcid.textContent=a,R.mcid.classList.remove("_empty")):(R.mcid.textContent=n,R.mcid.classList.add("_empty"))},a.onUploadFile=function(e){I=0,a.setState({loading:!0,bboxByPage:{}});var t=e.target.files[0],n=new FileReader;n.onload=a.onUploadEnd(t),t?n.readAsArrayBuffer(t):a.setState({pdf:null,loading:!1})},a.onUploadSctrictFile=function(e){I=0,a.setState({loading:!0,bboxByPage:{}}),a.onUploadEnd(e)},a.onUploadEnd=function(e){document.getElementById("container").innerHTML="",a.setState({numPages:null,pageNumber:1,pdf:e})},a.onError=function(e){a.setState({error:e.message,loading:!1})},a.state={numPages:null,pageNumber:1,pdf:h.a,title:h.a.name,boundingBoxes:null,renderedPages:0,error:null,structureTree:{},roleMap:{},classMap:{},loading:!0,bboxByPage:{}},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(){this.state.renderedPages===this.state.numPages&&(console.log("BBoxes",this.state.boundingBoxes),this.setState({renderedPages:0}))}},{key:"getPages",value:function(){for(var e=[],t=this.state.numPages,a=1;a<=t;a++)e.push(i.a.createElement(y,{pageIndex:a,onPageRenderSuccess:this.onPageRenderSuccess,key:"page-"+a}));return e}},{key:"setRef",value:function(e){return function(t){R[e]=t}}},{key:"isInBbox",value:function(e){var t=e.x,a=e.y,n=e.bboxList,i=!1;return Object.keys(n).forEach(function(e){var r=t>=n[e].x&&t<=n[e].x+n[e].width,o=a>=n[e].y&&a<=n[e].y+n[e].height;r&&o&&(i=B({},n[e],{mcid:e}))}),i}},{key:"render",value:function(){var e=this.state,t=e.numPages,a=e.title,n=e.loading;return i.a.createElement("div",{className:"App ".concat(n?"_loading":"")},i.a.createElement(D,{onUploadFile:this.onUploadFile,onUploadSctrictFile:this.onUploadSctrictFile,loading:n}),i.a.createElement("main",{className:"app-main-body"},i.a.createElement("div",{className:"pdf-wrapper"},i.a.createElement(f.Document,{file:this.state.pdf,onLoadSuccess:this.onDocumentLoadSuccess,options:{cMapUrl:"//cdn.jsdelivr.net/npm/pdfjs-dist@".concat(f.pdfjs.version,"/cmaps/"),cMapPacked:!0},onLoadError:this.onError,error:i.a.createElement("div",{className:"error-msg"},this.state.error)},this.getPages()))),i.a.createElement("div",{id:"container",ref:this.setRef("containerRef")}),i.a.createElement("div",{id:"tagInfo"},i.a.createElement("div",{className:"tag-prop"},i.a.createElement("div",{className:"tag-info-title"},"Document title"),i.a.createElement("div",{ref:this.setRef("activeTagName"),className:a?"":"_empty"},a||"None")),i.a.createElement("div",{className:"tag-prop"},i.a.createElement("div",{className:"tag-info-title"},"Number of pages"),i.a.createElement("div",{ref:this.setRef("activeTagName")},t)),i.a.createElement("div",{className:"tag-prop"},i.a.createElement("div",{className:"tag-info-title"},"Tag name"),i.a.createElement("div",{ref:this.setRef("activeTagName"),className:"_empty"},"None")),i.a.createElement("div",{className:"tag-prop"},i.a.createElement("div",{className:"tag-info-title"},"Tree path"),i.a.createElement("div",{ref:this.setRef("tagPath"),className:"_empty"},"None")),i.a.createElement("div",{className:"tag-prop"},i.a.createElement("div",{className:"tag-info-title"},"MCID"),i.a.createElement("div",{ref:this.setRef("mcid"),className:"_empty"},"None"))))}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},21:function(e,t,a){e.exports=a.p+"static/media/demo_tags.a5053dd1.pdf"},23:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=23},43:function(e,t,a){e.exports=a.p+"static/media/test_2.abc38450.pdf"},44:function(e,t,a){e.exports=a.p+"static/media/test.ba02e324.pdf"},45:function(e,t,a){e.exports=a.p+"static/media/huge.6e4e83bb.pdf"},46:function(e,t,a){e.exports=a.p+"static/media/test_page_tree_depth_2.4d676eff.pdf"},47:function(e,t,a){e.exports=a.p+"static/media/test_with_graphics.dddd5405.pdf"},51:function(e,t,a){e.exports=a(101)},59:function(e,t){},61:function(e,t){},62:function(e,t){},63:function(e,t){},64:function(e,t){}},[[51,1,2]]]);
//# sourceMappingURL=main.ed7600f0.chunk.js.map