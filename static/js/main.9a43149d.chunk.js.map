{"version":3,"sources":["components/PdfPage.js","components/Header.js","App.js","serviceWorker.js","index.js","files/demo_tags.pdf","../node_modules/pdfjs-dist/build sync","files/test_2.pdf","files/test.pdf","files/huge.pdf","files/test_page_tree_depth_2.pdf"],"names":["PdfPage","pageIndex","onPageRenderSuccess","className","pageNumber","renderAnnotationLayer","renderInteractiveForms","renderTextLayer","onRenderSuccess","customTextRenderer","height","width","transform","scale","page","str","disabledSize","Header","props","uploadInputRef","uploadTestPdf","size","file","testPdf","mediumPdf","bigPdf","hugePdf","testWithPageTreeDepth2","e","onUploadSctrictFile","app-btn-pane","onClick","disabled","loading","click","type","onChange","onUploadFile","ref","node","style","pdfjs","GlobalWorkerOptions","workerSrc","refs","containerRef","activeTagName","tagPath","loadedPages","App","onDocumentLoadSuccess","document","console","log","structureTree","_pdfInfo","getMetadata","then","info","RoleMap","metadata","contentDispositionFilename","ClassMap","title","Title","state","pdf","name","setState","roleMap","classMap","numPages","getOperatorList","data","positionData","argsArray","length","bboxByPage","rect","getElementsByTagName","getBoundingClientRect","bboxCanvas","createElement","top","y","left","x","position","id","setAttribute","appendChild","ctx","getContext","translate","onmousemove","onBboxMove","canvas","target","clientX","offsetHeight","clientY","getAttribute","bboxList","clearRect","offsetWidth","strokeStyle","bboxCoords","isInBbox","mcid","parseInt","getTagName","relatives","path","tagRoleMapPath","minX","maxX","minY","maxY","forEach","index","elementMcid","strokeRect","fillDocData","join","files","reader","FileReader","onload","onUploadEnd","readAsArrayBuffer","getElementById","innerHTML","onError","error","message","boundingBoxes","renderedPages","this","pagesArray","push","key","tagNode","Object","keys","nodeName","Array","mcidIndex","_","findIndex","getRelatives","filter","nodeFromArray","arrayOfRelatives","relative","entries","bbox","isX","isY","tagName","EMPTY","textContent","classList","remove","add","onLoadSuccess","options","cMapUrl","version","cMapPacked","onLoadError","getPages","setRef","React","Component","Boolean","window","location","hostname","match","ReactDOM","render","navigator","serviceWorker","ready","registration","unregister","module","exports","webpackEmptyContext","req","Error","code","resolve"],"mappings":"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","file":"static/js/main.9a43149d.chunk.js","sourcesContent":["import React from 'react';\r\nimport { Page } from \"react-pdf\";\r\n\r\nfunction PdfPage({ pageIndex, onPageRenderSuccess }) {\r\n    return (\r\n        <Page className=\"pdf-page\"\r\n              pageNumber={pageIndex}\r\n              renderAnnotationLayer={true}\r\n              renderInteractiveForms={true}\r\n              renderTextLayer={true}\r\n              onRenderSuccess={onPageRenderSuccess}\r\n              customTextRenderer={({height,  width, transform, scale, page, str}) => {\r\n                  /*\r\n                  height: height of text\r\n                  width: width of text\r\n                  transform: contain coordinates of text\r\n                  scale: will be used for coords. conversing\r\n                   */\r\n                  return str;\r\n              }}\r\n        />\r\n    );\r\n}\r\n\r\nexport default PdfPage;\r\n","import React from 'react';\r\n\r\nimport testPdf from '../files/demo_tags.pdf';\r\nimport mediumPdf from '../files/test_2.pdf';\r\nimport bigPdf from '../files/test.pdf';\r\nimport hugePdf from '../files/huge.pdf';\r\nimport testWithPageTreeDepth2 from '../files/test_page_tree_depth_2.pdf';\r\n\r\nlet disabledSize = 'small';\r\n\r\nfunction Header(props) {\r\n    let uploadInputRef;\r\n    function setUploadInputRef(node) {\r\n        uploadInputRef = node;\r\n    }\r\n\r\n    function onUploadPdfClick() {\r\n        uploadInputRef.click();\r\n    }\r\n\r\n    function uploadTestPdf(size) {\r\n        let file;\r\n        switch (size) {\r\n            case 'small':\r\n                file = testPdf;\r\n                break;\r\n            case 'medium':\r\n                file = mediumPdf;\r\n                break;\r\n            case 'big':\r\n                file = bigPdf;\r\n                break;\r\n            case 'huge':\r\n                file = hugePdf;\r\n                break;\r\n            case 'testWithPageTreeDepth2':\r\n                file = testWithPageTreeDepth2;\r\n                break;\r\n        }\r\n\r\n        return (e) => {\r\n            disabledSize = size;\r\n            props.onUploadSctrictFile(file);\r\n        };\r\n    }\r\n\r\n    return (\r\n        <header className=\"App-header\">\r\n            <section className=\"\"app-btn-pane>\r\n                <button onClick={uploadTestPdf('small')} className=\"app-btn\" disabled={disabledSize === 'small' || props.loading}>\r\n                    Small pdf\r\n                </button>\r\n                <button onClick={uploadTestPdf('medium')} className=\"app-btn\" disabled={disabledSize === 'medium' || props.loading}>\r\n                    Medium pdf\r\n                </button>\r\n                <button onClick={uploadTestPdf('big')} className=\"app-btn\" disabled={disabledSize === 'big' || props.loading}>\r\n                    Big pdf\r\n                </button>\r\n                <button onClick={uploadTestPdf('huge')} className=\"app-btn\" disabled={disabledSize === 'huge' || props.loading}>\r\n                    Huge pdf\r\n                </button>\r\n                <button onClick={uploadTestPdf('testWithPageTreeDepth2')} className=\"app-btn\" disabled={disabledSize === 'testWithPageTreeDepth2' || props.loading}>\r\n                    Pdf with page tree depth of 2\r\n                </button>\r\n                <button onClick={onUploadPdfClick} className=\"app-btn\" disabled={props.loading}>\r\n                    Upload other pdf\r\n                </button>\r\n                <input type='file' onChange={props.onUploadFile} ref={setUploadInputRef} style={{'display': 'none'}}/>\r\n            </section>\r\n            <div className=\"pdf-loading\">\r\n                {props.loading ? 'Loading pdf...' : ''}\r\n            </div>\r\n        </header>\r\n    );\r\n}\r\n\r\nexport default Header;\r\n","import React from 'react';\r\nimport { Document, pdfjs } from 'react-pdf';\r\nimport 'react-pdf/dist/Page/AnnotationLayer.css';\r\nimport testPdf from './files/demo_tags.pdf';\r\nimport _ from 'lodash';\r\n\r\nimport PdfPage from './components/PdfPage';\r\nimport Header from './components/Header';\r\nimport './scss/main.scss';\r\n\r\n//  Set pdf.js build\r\npdfjs.GlobalWorkerOptions.workerSrc = `pdf.worker.js`;\r\n//pdfjs.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.js`;\r\n\r\nlet refs = {\r\n    containerRef: null,\r\n    activeTagName: null,\r\n    tagPath: null,\r\n};\r\n\r\nlet loadedPages = 0;\r\n\r\nclass App extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            numPages: null,\r\n            pageNumber: 1,\r\n            pdf: testPdf,\r\n            title: testPdf.name,\r\n            boundingBoxes: null,\r\n            renderedPages: 0,\r\n            error: null,\r\n            structureTree: {},\r\n            roleMap: {},\r\n            classMap: {},\r\n            loading: true,\r\n            bboxByPage: {},\r\n        };\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        if (this.state.renderedPages === this.state.numPages) {\r\n            console.log('BBoxes', this.state.boundingBoxes);\r\n            this.setState({renderedPages: 0});\r\n        }\r\n    }\r\n\r\n    //  Init data of uploaded PDF\r\n    onDocumentLoadSuccess = (document) => {\r\n        console.log(document);\r\n        let structureTree = document._pdfInfo.structureTree || {};\r\n        document.getMetadata().then(({ info, metadata, contentDispositionFilename, }) => {\r\n            let { RoleMap, ClassMap, Title } = info;\r\n            let title = Title || this.state.pdf.name;\r\n            this.setState({\r\n                title,\r\n                structureTree,\r\n                roleMap: RoleMap || {},\r\n                classMap: ClassMap || {},\r\n            })\r\n        });\r\n        let {numPages} = document;\r\n        this.setState({ numPages });\r\n    };\r\n\r\n    //  Create page overlay for BBOXes\r\n    onPageRenderSuccess = (page) => {\r\n        page.getOperatorList().then((data) => {\r\n            let positionData = data.argsArray[data.argsArray.length - 1];\r\n            let bboxByPage = { ...this.state.bboxByPage };\r\n            bboxByPage[page.pageIndex] = positionData;\r\n            //console.log('Data:', positionData);\r\n\r\n            let canvas = document.getElementsByTagName('canvas')[page.pageIndex];\r\n            let rect = canvas.getBoundingClientRect();\r\n\r\n            let bboxCanvas = document.createElement('canvas');\r\n            bboxCanvas.style.top = rect.y + 'px';\r\n            bboxCanvas.style.left = rect.x + 'px';\r\n            bboxCanvas.style.height = rect.height + 'px';\r\n            bboxCanvas.style.width = rect.width + 'px';\r\n            bboxCanvas.height = rect.height;\r\n            bboxCanvas.width = rect.width;\r\n            bboxCanvas.style.position = 'absolute';\r\n            bboxCanvas.id = 'bboxCanvas' + page.pageIndex;\r\n            bboxCanvas.setAttribute('data-page', page.pageIndex);\r\n            refs.containerRef.appendChild(bboxCanvas);\r\n            let ctx = bboxCanvas.getContext('2d');\r\n            ctx.translate(0, rect.height);   // reset where 0,0 is located\r\n            ctx.scale(1,-1);\r\n\r\n            bboxCanvas.onmousemove = this.onBboxMove;\r\n\r\n            loadedPages++;\r\n            if (loadedPages === this.state.numPages) {\r\n                this.setState({\r\n                    loading: false,\r\n                    bboxByPage,\r\n                });\r\n            } else {\r\n                this.state.bboxByPage = bboxByPage;\r\n            }\r\n        });\r\n    }\r\n\r\n    //  Build pages\r\n    getPages() {\r\n        let pagesArray = [];\r\n        let { numPages } = this.state;\r\n\r\n        for (let pageIndex = 1; pageIndex <= numPages; pageIndex++) {\r\n            pagesArray.push(\r\n                <PdfPage pageIndex={pageIndex}\r\n                         onPageRenderSuccess={this.onPageRenderSuccess}\r\n                         key={\"page-\" + pageIndex}\r\n                />\r\n            );\r\n        }\r\n\r\n        return pagesArray;\r\n    }\r\n\r\n    /*\r\n     * Get tag name of hovered bbox\r\n     * @param mcid {integer} id of bbox\r\n     * @param tagNode {object} structure for searching\r\n     * @param pageIndex {integer} tough pageIndex prevent confusing of wrong tag with similar mcid\r\n     *\r\n     * @return {\r\n     *      name {string} tag name\r\n     *      relatives {array} tags from the same level\r\n     *      path {string} path to component through structure tree\r\n     * }\r\n     */\r\n    getTagName({mcid, tagNode, pageIndex}) {\r\n        if (!tagNode && tagNode !== 0) {\r\n            tagNode = {...this.state.structureTree};\r\n        }\r\n        pageIndex = parseInt(pageIndex);\r\n        let node = '';\r\n        let relatives = [];\r\n        let path = [];\r\n        let page = 0;\r\n        Object.keys(tagNode).forEach((nodeName) => {\r\n            path = [nodeName];\r\n            if (tagNode[nodeName] &&(tagNode[nodeName].mcid || tagNode[nodeName].mcid === 0)\r\n                && tagNode[nodeName].mcid === mcid\r\n                && tagNode[nodeName].pageIndex === pageIndex\r\n            ) {\r\n                node = nodeName;\r\n                page = tagNode[nodeName].pageIndex;\r\n            } else if (tagNode[nodeName] instanceof Array) {\r\n                let mcidIndex = _.findIndex(tagNode[nodeName], {mcid, pageIndex});\r\n                if (mcidIndex > -1) {\r\n                    node = nodeName;\r\n                    page = tagNode[nodeName][mcidIndex].pageIndex;\r\n                    relatives = this.getRelatives(tagNode[nodeName]);\r\n                } else {\r\n                    node = tagNode[nodeName].filter((nodeFromArray) => {\r\n                        if (!nodeFromArray) {\r\n                            return false;\r\n                        }\r\n                        return !!this.getTagName({mcid, tagNode: nodeFromArray, pageIndex}).name;\r\n                    })[0];\r\n                    if (node) {\r\n                        node = this.getTagName({mcid, tagNode: node, pageIndex});\r\n                        relatives = node.relatives;\r\n                        path = [...path, ...node.path];\r\n                        page = node.page;\r\n                        node = node.name;\r\n                    }\r\n                }\r\n            } else if (tagNode[nodeName] && (!tagNode[nodeName].mcid && tagNode[nodeName].mcid !== 0) || tagNode[nodeName] instanceof Object) {\r\n                node = this.getTagName({mcid, tagNode: tagNode[nodeName], pageIndex});\r\n                relatives = node.relatives;\r\n                path = [...path, ...node.path];\r\n                page = node.page;\r\n                node = node.name;\r\n            }\r\n        });\r\n\r\n        return {\r\n            name: node,\r\n            relatives,\r\n            path,\r\n            page,\r\n        };\r\n    }\r\n\r\n    //  Get components from on level\r\n    getRelatives(arrayOfRelatives) {\r\n        let relatives = [];\r\n        arrayOfRelatives.forEach((relative) => {\r\n            if (!relative) return;\r\n            if (relative.mcid) {\r\n                relatives.push(relative);\r\n            } else if (relative instanceof Array && relative.length) {\r\n                relatives = [\r\n                    ...relatives,\r\n                    ...this.getRelatives(relative)\r\n                ];\r\n            } else if (relative instanceof Object) {\r\n                relatives = [\r\n                    ...relatives,\r\n                    ...this.getRelatives(Object.entries(relative))\r\n                ];\r\n            }\r\n        });\r\n\r\n        return relatives;\r\n    }\r\n\r\n    //  Set React ref\r\n    setRef(target) {\r\n        return (node) => {\r\n            refs[target] = node;\r\n        };\r\n    }\r\n\r\n    isInBbox({x, y, bboxList}) {\r\n        let bbox = false;\r\n        Object.keys(bboxList).forEach((key) => {\r\n            let isX = x >= bboxList[key].x && x <= (bboxList[key].x + bboxList[key].width);\r\n            let isY = y >= bboxList[key].y && y <= (bboxList[key].y + bboxList[key].height);\r\n\r\n            if (isX && isY) {\r\n                bbox = {\r\n                    ...bboxList[key],\r\n                    mcid: key,\r\n                };\r\n            }\r\n        });\r\n\r\n        return bbox;\r\n    }\r\n\r\n    /*\r\n    *   HANDLERS\r\n     */\r\n\r\n    onBboxMove = (e) => {\r\n        let canvas = e.target;\r\n        let rect = canvas.getBoundingClientRect();\r\n        let x = e.clientX - rect.left;\r\n        let y = canvas.offsetHeight - (e.clientY - rect.top);\r\n        let ctx = canvas.getContext('2d');\r\n        let pageIndex = canvas.getAttribute('data-page');\r\n        let bboxList = this.state.bboxByPage[pageIndex];\r\n\r\n        ctx.clearRect(0, 0, canvas.offsetWidth, canvas.offsetHeight);\r\n        ctx.strokeStyle = 'red';\r\n        let bboxCoords = this.isInBbox({ x, y, bboxList});\r\n        if (!bboxCoords) {\r\n            this.fillDocData();\r\n            return;\r\n        }\r\n\r\n        let mcid = parseInt(bboxCoords.mcid);\r\n        let { name, relatives, path, page } = this.getTagName({mcid, pageIndex});\r\n        let tagRoleMapPath = '';\r\n        let minX = 0;\r\n        let maxX = 0;\r\n        let minY = 0;\r\n        let maxY = 0;\r\n        delete relatives[mcid];\r\n        relatives.forEach(({mcid: elementMcid, pageIndex}, index) => {\r\n            if (pageIndex !== page || !bboxList[elementMcid]) return;\r\n            let {x, y, width, height} = bboxList[elementMcid];\r\n            if (!index) {\r\n                minX = x;\r\n                maxX = x + width;\r\n                minY = y;\r\n                maxY = y + height;\r\n            }\r\n\r\n            minX = minX < x ? minX : x;\r\n            maxX = maxX > (x + width) ? maxX : (x + width);\r\n            minY = minY < y ? minY : y;\r\n            maxY = maxY > (y + height) ? maxY : (y + height);\r\n        });\r\n\r\n        if (relatives.length) {\r\n            ctx.strokeRect(minX, minY, maxX-minX, maxY-minY);\r\n        } else {\r\n            ctx.strokeRect(bboxCoords.x, bboxCoords.y, bboxCoords.width, bboxCoords.height);\r\n        }\r\n\r\n        if (this.state.roleMap[name]) {\r\n            tagRoleMapPath = '-> ' + this.state.roleMap[name].name;\r\n        }\r\n\r\n        this.fillDocData(`${name} ${tagRoleMapPath}`, path.join(' -> '));\r\n    }\r\n\r\n    fillDocData(tagName = null, tagPath = null) {\r\n        const EMPTY = 'None';\r\n\r\n        if (tagName) {\r\n            refs.activeTagName.textContent = tagName;\r\n            refs.tagPath.classList.remove('_empty');\r\n        } else {\r\n            refs.activeTagName.textContent = EMPTY;\r\n            refs.tagPath.classList.add('_empty');\r\n        }\r\n\r\n        if (tagPath) {\r\n            refs.tagPath.textContent = tagPath;\r\n            refs.activeTagName.classList.remove('_empty');\r\n        } else {\r\n            refs.tagPath.textContent = EMPTY;\r\n            refs.activeTagName.classList.add('_empty');\r\n        }\r\n    }\r\n\r\n    onUploadFile = (e) => {\r\n        loadedPages = 0;\r\n        this.setState({\r\n            loading: true,\r\n            bboxByPage: {},\r\n        });\r\n        let file = e.target.files[0];\r\n        let reader = new FileReader();\r\n\r\n        reader.onload = this.onUploadEnd(file);\r\n\r\n        if (!file) {\r\n            this.setState({\r\n                pdf: null,\r\n                loading: false,\r\n            });\r\n            return;\r\n        }\r\n        reader.readAsArrayBuffer(file);\r\n    }\r\n\r\n    onUploadSctrictFile = (pdf) => {\r\n        loadedPages = 0;\r\n        this.setState({\r\n            loading: true,\r\n            bboxByPage: {},\r\n        });\r\n        this.onUploadEnd(pdf);\r\n    }\r\n\r\n    onUploadEnd = (pdf) => {\r\n        document.getElementById('container').innerHTML = \"\";\r\n\r\n        this.setState({\r\n            numPages: null,\r\n            pageNumber: 1,\r\n            pdf,\r\n        })\r\n    }\r\n\r\n    onError = (e) => {\r\n        this.setState({\r\n            error: e.message,\r\n            loading: false,\r\n        });\r\n    }\r\n\r\n    render() {\r\n        const { numPages, title, loading } = this.state;\r\n        return (\r\n            <div className={`App ${loading ? '_loading' : ''}`}>\r\n                <Header onUploadFile={this.onUploadFile} onUploadSctrictFile={this.onUploadSctrictFile} loading={loading}/>\r\n                <main className=\"app-main-body\">\r\n                    <div className=\"pdf-wrapper\">\r\n                        <Document file={this.state.pdf}\r\n                                  onLoadSuccess={this.onDocumentLoadSuccess}\r\n                                  options={{\r\n                                      cMapUrl: `//cdn.jsdelivr.net/npm/pdfjs-dist@${pdfjs.version}/cmaps/`,\r\n                                      cMapPacked: true,\r\n                                  }}\r\n                                  onLoadError={this.onError}\r\n                                  error={<div className=\"error-msg\">{this.state.error}</div> }\r\n                        >\r\n                            {this.getPages()}\r\n                        </Document>\r\n                    </div>\r\n                </main>\r\n                <div id=\"container\" ref={this.setRef('containerRef')}/>\r\n                <div id=\"tagInfo\">\r\n                    <div className=\"tag-prop\">\r\n                        <div className=\"tag-info-title\">Document title</div>\r\n                        <div ref={this.setRef('activeTagName')} className={title ? '' : '_empty'}>{title || 'None'}</div>\r\n                    </div>\r\n                    <div className=\"tag-prop\">\r\n                        <div className=\"tag-info-title\">Number of pages</div>\r\n                        <div ref={this.setRef('activeTagName')}>{numPages}</div>\r\n                    </div>\r\n                    <div className=\"tag-prop\">\r\n                        <div className=\"tag-info-title\">Tag name</div>\r\n                        <div ref={this.setRef('activeTagName')} className=\"_empty\">None</div>\r\n                    </div>\r\n                    <div className=\"tag-prop\">\r\n                        <div className=\"tag-info-title\">Tree path</div>\r\n                        <div ref={this.setRef('tagPath')} className=\"_empty\">None</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","module.exports = __webpack_public_path__ + \"static/media/demo_tags.a5053dd1.pdf\";","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 23;","module.exports = __webpack_public_path__ + \"static/media/test_2.abc38450.pdf\";","module.exports = __webpack_public_path__ + \"static/media/test.ba02e324.pdf\";","module.exports = __webpack_public_path__ + \"static/media/huge.6e4e83bb.pdf\";","module.exports = __webpack_public_path__ + \"static/media/test_page_tree_depth_2.4d676eff.pdf\";"],"sourceRoot":""}