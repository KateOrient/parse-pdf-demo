(window["webpackJsonpreact-pdf-test"]=window["webpackJsonpreact-pdf-test"]||[]).push([[0],{22:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=22},28:function(e,t,a){e.exports=a.p+"static/media/demo_tags.a5053dd1.pdf"},45:function(e,t,a){e.exports=a(96)},50:function(e,t,a){},54:function(e,t){},56:function(e,t){},57:function(e,t){},58:function(e,t){},59:function(e,t){},95:function(e,t,a){},96:function(e,t,a){"use strict";a.r(t);var n,r,o=a(0),s=a.n(o),c=a(38),i=a.n(c),l=(a(50),a(17)),u=a(39),d=a(40),m=a(43),p=a(41),g=a(44),f=a(20),h=(a(94),a(95),a(28)),v=a.n(h),b=a(42),y=a.n(b);f.pdfjs.GlobalWorkerOptions.workerSrc="pdf.worker.js";var E=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).onDocumentLoadSuccess=function(e){console.log(e);var t=e._pdfInfo.structureTree||{};e.getMetadata().then(function(e){var n=e.info,r=(e.metadata,e.contentDispositionFilename,n.RoleMap),o=n.ClassMap,s=n.Title||a.state.pdf.name;a.setState({title:s,structureTree:t,roleMap:r||{},classMap:o||{}})});var n=e.numPages;a.setState({numPages:n})},a.onPageRenderSuccess=function(e){e.getOperatorList().then(function(t){var n=t.argsArray[t.argsArray.length-1];console.log("Data:",n);var o=document.getElementsByTagName("canvas")[e.pageIndex],s=o.getBoundingClientRect(),c=document.createElement("div");c.innerHTML="",c.style.top=s.y+"px",c.style.left=s.x+"px",c.style.height=s.height+"px",c.style.width=s.width+"px",c.style.position="absolute",c.id="div"+e.pageIndex,r.appendChild(c),c=document.getElementById("div"+e.pageIndex),y.a.map(n,function(e,t){var n=document.createElement("div");n.style.top=parseInt(o.style.height,10)-e.y-e.height+"px",n.style.left=e.x+"px",n.style.height=e.height+"px",n.style.width=e.width+"px",n.className="bbox",n.setAttribute("data-mcid",t),n.title=t,n.onmouseover=a.onBboxOver,n.onmouseout=a.onBboxOut,c.appendChild(n)})})},a.onBboxOver=function(e){var t=parseInt(e.target.getAttribute("data-mcid")),n=a.getTagName(t),r=n.name,o=n.relatives,s="";e.target.getAttribute("data-tag-name")||e.target.setAttribute("data-tag-name",r),o.forEach(function(e){document.querySelector('[data-mcid="'.concat(e,'"]')).classList.add("_hovered")}),e.target.classList.add("_hovered"),a.state.roleMap[r]&&(s="-> "+a.state.roleMap[r].name),a.setState({activeTagName:"".concat(r," ").concat(s)})},a.onBboxOut=function(e){Object(l.a)(document.querySelectorAll("._hovered")).forEach(function(e){e.classList.remove("_hovered")}),a.setState({activeTagName:""})},a.uploadFile=function(e){var t=e.target.files[0],n=new FileReader;n.onload=a._onUploadEnd(t),t?n.readAsArrayBuffer(t):a.setState({pdf:null})},a.uploadPdf=function(){n.click()},a._onUploadEnd=function(e){document.getElementById("container").innerHTML="",a.setState({numPages:null,pageNumber:1,pdf:e})},a.onError=function(e){a.setState({error:e.message})},a.state={numPages:null,pageNumber:1,pdf:v.a,title:v.a.name,boundingBoxes:null,renderedPages:0,error:null,structureTree:{},roleMap:{},classMap:{},activeTagName:null},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(){this.state.renderedPages===this.state.numPages&&(console.log("BBoxes",this.state.boundingBoxes),this.setState({renderedPages:0}))}},{key:"getTagName",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.structureTree,n="",r=[];return Object.keys(a).forEach(function(o){a[o]===e?n=o:a[o]instanceof Array?a[o].includes(e)?(n=o,r=t.getRelatives(a[o])):(n=a[o].filter(function(a){return!!a&&!!t.getTagName(e,a).name})[0])&&(n=t.getTagName(e,n),r=n.relatives,n=n.name):a[o]instanceof Object&&(n=t.getTagName(e,a[o]),r=n.relatives,n=n.name)}),{name:n,relatives:r}}},{key:"getRelatives",value:function(e){var t=this,a=[];return e.forEach(function(e){e&&("number"===typeof e?a.push(e):e instanceof Array&&e.length?a=[].concat(Object(l.a)(a),Object(l.a)(t.getRelatives(e))):e instanceof Object&&(a=[].concat(Object(l.a)(a),Object(l.a)(t.getRelatives(Object.entries(e))))))}),a}},{key:"_setRef",value:function(e){n=e}},{key:"setContainerRef",value:function(e){r=e}},{key:"render",value:function(){var e=this.state,t=e.pageNumber,a=e.numPages,n=e.title;return s.a.createElement("div",{className:"App"},s.a.createElement("header",{className:"App-header"},s.a.createElement("button",{onClick:this.uploadPdf},"Upload other pdf"),s.a.createElement("input",{type:"file",onChange:this.uploadFile.bind(this),ref:this._setRef,style:{display:"none"}})),s.a.createElement("article",{className:"app-main-body"},s.a.createElement("div",{className:"pdf-data"},s.a.createElement("p",null,s.a.createElement("b",null,"Title: "),n),s.a.createElement("p",null,s.a.createElement("b",null,"Number of pages: "),a)),s.a.createElement("div",{className:"pdf-wrapper"},s.a.createElement(f.Document,{file:this.state.pdf,onLoadSuccess:this.onDocumentLoadSuccess,options:{cMapUrl:"//cdn.jsdelivr.net/npm/pdfjs-dist@".concat(f.pdfjs.version,"/cmaps/"),cMapPacked:!0},onLoadError:this.onError,error:s.a.createElement("div",{className:"error-msg"},this.state.error)},function(e){for(var t=e.numPages,a=e.onPageRenderSuccess,n=[],r=1;r<=t;r++)n.push(s.a.createElement(f.Page,{className:"pdf-page",pageNumber:r,key:"page-".concat(r),renderAnnotationLayer:!0,renderInteractiveForms:!0,renderTextLayer:!0,onRenderSuccess:a,customTextRenderer:function(e){e.height,e.width,e.transform,e.scale,e.page;return e.str}}));return n}({pageNumber:t,numPages:a,onPageRenderSuccess:this.onPageRenderSuccess})))),s.a.createElement("div",{id:"container",ref:this.setContainerRef}),s.a.createElement("div",{id:"tagInfo"},s.a.createElement("div",null,s.a.createElement("span",{className:"tag-info-title"},"Tag name: "),this.state.activeTagName)))}}]),t}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(E,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[45,1,2]]]);
//# sourceMappingURL=main.576aca57.chunk.js.map